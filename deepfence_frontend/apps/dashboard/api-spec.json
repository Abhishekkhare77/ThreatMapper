{
  "openapi": "3.0.3",
  "info": {
    "title": "Deepfence ThreatMapper",
    "description": "Deepfence Runtime API provides programmatic control over Deepfence microservice securing your container, kubernetes and cloud deployments. The API abstracts away underlying infrastructure details like cloud provider, \ncontainer distros, container orchestrator and type of deployment. This is one uniform API to manage and control security alerts, policies and response to alerts for microservices running anywhere i.e. managed pure greenfield container deployments or a mix of containers, VMs and serverless paradigms like AWS Fargate.",
    "termsOfService": "/tos",
    "contact": {
      "name": "Deepfence Support",
      "url": "https://deepfence.io",
      "email": "community@deepfence.io"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0"
    },
    "version": "2.0.0"
  },
  "externalDocs": {
    "description": "Deepfence Community",
    "url": "https://community.deepfence.io"
  },
  "tags": [
    { "name": "Authentication" },
    { "name": "Common" },
    { "name": "Compliance" },
    { "name": "Topology" },
    { "name": "Secret Scan" },
    { "name": "Vulnerability" }
  ],
  "paths": {
    "/deepfence/api-token": {
      "get": {
        "tags": ["User"],
        "summary": "Get User's API Tokens",
        "description": "Get logged in user's API Tokens",
        "operationId": "getApiTokens",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/auth/token": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Get Access Token for API Token",
        "description": "Get access token for programmatic API access, by providing API Token",
        "operationId": "authToken",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelApiAuthRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        }
      }
    },
    "/deepfence/auth/token/refresh": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Refresh access token",
        "description": "Reissue access token using refresh token",
        "operationId": "authTokenRefresh",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/controls/agent": {
      "post": {
        "tags": ["Controls"],
        "summary": "Fetch Agent Actions",
        "description": "Fetch actions for a given agent",
        "operationId": "getAgentControls",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelAgentId" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ControlsAgentControls" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/controls/agent-init": {
      "post": {
        "tags": ["Controls"],
        "summary": "Fetch Agent Init Actions",
        "description": "Fetch initial actions for a given agent after it started",
        "operationId": "getAgentInitControls",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelAgentId" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ControlsAgentControls" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/diagnosis/agent-logs": {
      "post": {
        "tags": ["Diagnosis"],
        "summary": "Generate Agent Diagnostic Logs",
        "description": "Generate Agent Diagnostic Logs",
        "operationId": "generateAgentDiagnosticLogs",
        "responses": {
          "202": { "description": "Accepted" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/diagnosis/console-logs": {
      "post": {
        "tags": ["Diagnosis"],
        "summary": "Generate Console Diagnostic Logs",
        "description": "Generate Console Diagnostic Logs",
        "operationId": "generateConsoleDiagnosticLogs",
        "responses": {
          "202": { "description": "Accepted" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/diagnosis/diagnostic-logs": {
      "get": {
        "tags": ["Diagnosis"],
        "summary": "Get Diagnostic Logs",
        "description": "Get diagnostic logs download url links",
        "operationId": "getDiagnosticLogs",
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/diagnosis/notification": {
      "get": {
        "tags": ["Diagnosis"],
        "summary": "Get Diagnostic Notification",
        "description": "Get Diagnostic Notification",
        "operationId": "diagnosticNotification",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/graph/threat": {
      "post": {
        "tags": ["Threat"],
        "summary": "Get Threat Graph",
        "description": "Retrieve the full threat graph associated with the account",
        "operationId": "getThreatGraph",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ReportersThreatGraph" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/graph/topology/": {
      "post": {
        "tags": ["Topology"],
        "summary": "Get Topology Graph",
        "description": "Retrieve the full topology graph associated with the account",
        "operationId": "getTopologyGraph",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersTopologyFilters" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsGraphResult" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/graph/topology/containers": {
      "post": {
        "tags": ["Topology"],
        "summary": "Get Containers Topology Graph",
        "description": "Retrieve the full topology graph associated with the account from Containers",
        "operationId": "getContainersTopologyGraph",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersTopologyFilters" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsGraphResult" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/graph/topology/hosts": {
      "post": {
        "tags": ["Topology"],
        "summary": "Get Hosts Topology Graph",
        "description": "Retrieve the full topology graph associated with the account from Hosts",
        "operationId": "getHostsTopologyGraph",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersTopologyFilters" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsGraphResult" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/graph/topology/kubernetes": {
      "post": {
        "tags": ["Topology"],
        "summary": "Get Kubernetes Topology Graph",
        "description": "Retrieve the full topology graph associated with the account from Kubernetes",
        "operationId": "getKubernetesTopologyGraph",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersTopologyFilters" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsGraphResult" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/graph/topology/pods": {
      "post": {
        "tags": ["Topology"],
        "summary": "Get Pods Topology Graph",
        "description": "Retrieve the full topology graph associated with the account from Pods",
        "operationId": "getPodsTopologyGraph",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersTopologyFilters" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsGraphResult" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/cloud-compliance": {
      "post": {
        "tags": ["Cloud Compliance"],
        "summary": "Ingest Cloud Compliances",
        "description": "Ingest Cloud compliances found while scanning cloud provider",
        "operationId": "ingestCloudCompliances",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/IngestersCloudCompliance" },
                "nullable": true
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/cloud-resources": {
      "post": {
        "tags": ["Cloud Resources"],
        "summary": "Ingest Cloud resources",
        "description": "Ingest Clouds Resources found while scanning cloud provider",
        "operationId": "ingestCloudResources",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/IngestersCloudResource" },
                "nullable": true
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/compliance": {
      "post": {
        "tags": ["Compliance"],
        "summary": "Ingest Compliances",
        "description": "Ingest compliance issues found while scanning the agent",
        "operationId": "ingestCompliances",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/IngestersCompliance" },
                "nullable": true
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/report": {
      "post": {
        "tags": ["Topology"],
        "summary": "Ingest Topology Data",
        "description": "Ingest data reported by one Agent",
        "operationId": "ingestAgentReport",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelRawReport" }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/secret-scan-logs": {
      "post": {
        "tags": ["Secret Scan"],
        "summary": "Ingest Secrets Scan Status",
        "description": "Ingest secrets scan status from the agent",
        "operationId": "ingestSecretScanStatus",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/IngestersSecretScanStatus" },
                "nullable": true
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/secrets": {
      "post": {
        "tags": ["Secret Scan"],
        "summary": "Ingest Secrets",
        "description": "Ingest secrets found while scanning the agent",
        "operationId": "ingestSecrets",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/IngestersSecret" },
                "nullable": true
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/ingest/vulnerabilities": {
      "post": {
        "tags": ["Vulnerability"],
        "summary": "Ingest Vulnerabilities",
        "description": "Ingest vulnerabilities found while scanning the agent host or containers",
        "operationId": "ingestVulnerabilities",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/IngestersVulnerability" },
                "nullable": true
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/lookup/containers": {
      "post": {
        "tags": ["Lookup"],
        "summary": "Retrieve Containers data",
        "description": "Retrieve all the data associated with containers",
        "operationId": "getContainers",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersLookupFilter" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/ModelContainer" }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/lookup/hosts": {
      "post": {
        "tags": ["Lookup"],
        "summary": "Retrieve Hosts data",
        "description": "Retrieve all the data associated with hosts",
        "operationId": "getHosts",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersLookupFilter" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/ModelHost" }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/lookup/processes": {
      "post": {
        "tags": ["Lookup"],
        "summary": "Retrieve Processes data",
        "description": "Retrieve all the data associated with processes",
        "operationId": "getProcesses",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReportersLookupFilter" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/ModelProcess" }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/list/compliance": {
      "post": {
        "tags": ["Compliance"],
        "summary": "Get Compliance Scans List",
        "description": "Get Compliance Scans list on agent or registry",
        "operationId": "listComplianceScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanListReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanListResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/list/malware": {
      "post": {
        "tags": ["Malware Scan"],
        "summary": "Get Malware Scans List",
        "description": "Get Malware Scans list on agent or registry",
        "operationId": "listMalwareScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanListReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanListResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/list/secret": {
      "post": {
        "tags": ["Secret Scan"],
        "summary": "Get Secret Scans List",
        "description": "Get Secret Scans list on agent or registry",
        "operationId": "listSecretScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanListReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanListResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/list/vulnerability": {
      "post": {
        "tags": ["Vulnerability"],
        "summary": "Get Vulnerability Scans List",
        "description": "Get Vulnerability Scan list on agent or registry",
        "operationId": "listVulnerabilityScans",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanListReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanListResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/results/compliance": {
      "post": {
        "tags": ["Compliance"],
        "summary": "Get Compliance Scans Results",
        "description": "Get Compliance Scans results on agent or registry",
        "operationId": "resultsComplianceScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanResultsReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanResultsResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/results/malware": {
      "post": {
        "tags": ["Malware Scan"],
        "summary": "Get Malware Scans Results",
        "description": "Get Malware Scans results on agent or registry",
        "operationId": "resultsMalwareScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanResultsReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanResultsResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/results/secret": {
      "post": {
        "tags": ["Secret Scan"],
        "summary": "Get Secret Scans Results",
        "description": "Get Secret Scans results on agent or registry",
        "operationId": "resultsSecretScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanResultsReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanResultsResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/results/vulnerability": {
      "post": {
        "tags": ["Vulnerability"],
        "summary": "Get Vulnerability Scans Results",
        "description": "Get Vulnerability Scan results on agent or registry",
        "operationId": "resultsVulnerabilityScans",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanResultsReq" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanResultsResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/start/compliance": {
      "post": {
        "tags": ["Compliance"],
        "summary": "Start Compliance Scan",
        "description": "Start Compliance Scan on agent or registry",
        "operationId": "startComplianceScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanTriggerResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/start/malware": {
      "post": {
        "tags": ["Malware Scan"],
        "summary": "Start Malware Scan",
        "description": "Start Malware Scan on agent or registry",
        "operationId": "startMalwareScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanTriggerResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/start/secret": {
      "post": {
        "tags": ["Secret Scan"],
        "summary": "Start Secret Scan",
        "description": "Start Secret Scan on agent or registry",
        "operationId": "startSecretScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanTriggerResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/start/vulnerability": {
      "post": {
        "tags": ["Vulnerability"],
        "summary": "Start Vulnerability Scan",
        "description": "Start Vulnerability Scan on agent or registry",
        "operationId": "startVulnerabilityScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanTriggerResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/status/compliance": {
      "get": {
        "tags": ["Compliance"],
        "summary": "Get Compliance Scan Status",
        "description": "Get Compliance Scan Status on agent or registry",
        "operationId": "statusComplianceScan",
        "parameters": [
          {
            "name": "scan_id",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanStatusResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/status/malware": {
      "get": {
        "tags": ["Malware Scan"],
        "summary": "Get Malware Scan Status",
        "description": "Get Malware Scan status on agent or registry",
        "operationId": "statusMalwareScan",
        "parameters": [
          {
            "name": "scan_id",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanStatusResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/status/secret": {
      "get": {
        "tags": ["Secret Scan"],
        "summary": "Get Secret Scan Status",
        "description": "Get Secret Scan Status on agent or registry",
        "operationId": "statusSecretScan",
        "parameters": [
          {
            "name": "scan_id",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanStatusResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/status/vulnerability": {
      "get": {
        "tags": ["Vulnerability"],
        "summary": "Get Vulnerability Scan Status",
        "description": "Get Vulnerability Scan Status on agent or registry",
        "operationId": "statusVulnerabilityScan",
        "parameters": [
          {
            "name": "scan_id",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelScanStatusResp" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/stop/compliance": {
      "post": {
        "tags": ["Compliance"],
        "summary": "Stop Compliance Scan",
        "description": "Stop Compliance Scan on agent or registry",
        "operationId": "stopComplianceScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": { "description": "Accepted" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/stop/malware": {
      "post": {
        "tags": ["Malware Scan"],
        "summary": "Stop Malware Scan",
        "description": "Stop Malware Scan on agent or registry",
        "operationId": "stopMalwareScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": { "description": "Accepted" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/stop/secret": {
      "post": {
        "tags": ["Secret Scan"],
        "summary": "Stop Secret Scan",
        "description": "Stop Secret Scan on agent or registry",
        "operationId": "stopSecretScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": { "description": "Accepted" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/scan/stop/vulnerability": {
      "post": {
        "tags": ["Vulnerability"],
        "summary": "Stop Vulnerability Scan",
        "description": "Stop Vulnerability Scan on agent or registry",
        "operationId": "stopVulnerabilityScan",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelScanTriggerReq" }
            }
          }
        },
        "responses": {
          "202": { "description": "Accepted" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/user": {
      "delete": {
        "tags": ["User"],
        "summary": "Delete Current User",
        "description": "Delete logged in user",
        "operationId": "deleteCurrentUser",
        "responses": {
          "204": { "description": "No Content" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      },
      "get": {
        "tags": ["User"],
        "summary": "Get Current User",
        "description": "Get logged in user information",
        "operationId": "getCurrentUser",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      },
      "put": {
        "tags": ["User"],
        "summary": "Update Current User",
        "description": "Update logged in user information",
        "operationId": "updateCurrentUser",
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/ModelUser" } }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/user/login": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Login API",
        "description": "Login API",
        "operationId": "login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelLoginRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        }
      }
    },
    "/deepfence/user/logout": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Logout API",
        "description": "Logout API",
        "operationId": "logout",
        "responses": {
          "204": { "description": "No Content" },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        },
        "security": [{ "bearer_token": [] }]
      }
    },
    "/deepfence/user/register": {
      "post": {
        "tags": ["User"],
        "summary": "Register User",
        "description": "First user registration. Further users needs to be invited.",
        "operationId": "registerUser",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ModelUserRegisterRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModelResponse" }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsBadRequestResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized" },
          "403": { "description": "Forbidden" },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ApiDocsFailureResponse" }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ApiDocsBadRequestResponse": {
        "type": "object",
        "properties": {
          "error_fields": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "nullable": true
          },
          "message": { "type": "string" },
          "success": { "type": "boolean", "example": false }
        }
      },
      "ApiDocsFailureResponse": {
        "type": "object",
        "properties": {
          "message": { "type": "string" },
          "success": { "type": "boolean", "example": false }
        }
      },
      "ApiDocsGraphResult": {
        "required": ["nodes", "edges"],
        "type": "object",
        "properties": {
          "edges": { "$ref": "#/components/schemas/DetailedTopologyConnectionSummaries" },
          "nodes": { "$ref": "#/components/schemas/DetailedNodeSummaries" }
        }
      },
      "ControlsAction": {
        "required": ["id", "request_payload"],
        "type": "object",
        "properties": {
          "id": { "$ref": "#/components/schemas/ControlsActionID" },
          "request_payload": { "type": "string" }
        }
      },
      "ControlsActionID": { "type": "integer" },
      "ControlsAgentControls": {
        "required": ["beatrate", "commands"],
        "type": "object",
        "properties": {
          "beatrate": { "type": "integer" },
          "commands": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ControlsAction" },
            "nullable": true
          }
        }
      },
      "DetailedConnectionSummary": {
        "type": "object",
        "properties": { "source": { "type": "string" }, "target": { "type": "string" } }
      },
      "DetailedNodeSummaries": {
        "type": "object",
        "additionalProperties": { "$ref": "#/components/schemas/DetailedNodeSummary" }
      },
      "DetailedNodeSummary": {
        "type": "object",
        "properties": {
          "adjacency": { "$ref": "#/components/schemas/ReportIDList" },
          "id": { "type": "string" },
          "image": { "type": "string" },
          "immediate_parent_id": { "type": "string" },
          "label": { "type": "string" },
          "labelMinor": { "type": "string" },
          "metadata": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ReportMetadataRow" }
          },
          "metrics": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ReportMetricRow" }
          },
          "parents": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/DetailedParent" }
          },
          "pseudo": { "type": "boolean" },
          "rank": { "type": "string" },
          "shape": { "type": "string" },
          "stack": { "type": "boolean" },
          "tables": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ReportTable" }
          },
          "tag": { "type": "string" },
          "type": { "type": "string" }
        }
      },
      "DetailedParent": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "label": { "type": "string" },
          "topologyId": { "type": "string" }
        }
      },
      "DetailedTopologyConnectionSummaries": {
        "type": "object",
        "additionalProperties": {
          "$ref": "#/components/schemas/DetailedConnectionSummary"
        }
      },
      "DiagnosisDiagnosticNotification": {
        "type": "object",
        "properties": {
          "content": { "type": "string" },
          "expiry_in_secs": {},
          "follow_url": {},
          "source_application_id": { "type": "string" },
          "updated_at": { "type": "string" }
        }
      },
      "IngestersCloudCompliance": {
        "type": "object",
        "properties": {
          "@timestamp": { "type": "string" },
          "account_id": { "type": "string" },
          "cloud_provider": { "type": "string" },
          "compliance_check_type": { "type": "string" },
          "control_id": { "type": "string" },
          "count": { "type": "integer" },
          "description": { "type": "string" },
          "doc_id": { "type": "string" },
          "group": { "type": "string" },
          "masked": { "type": "string" },
          "node_id": { "type": "string" },
          "node_name": { "type": "string" },
          "reason": { "type": "string" },
          "region": { "type": "string" },
          "resource": { "type": "string" },
          "scan_id": { "type": "string" },
          "service": { "type": "string" },
          "severity": { "type": "string" },
          "status": { "type": "string" },
          "title": { "type": "string" },
          "type": { "type": "string" }
        }
      },
      "IngestersCloudResource": {
        "type": "object",
        "properties": {
          "account_id": { "type": "string" },
          "allow_blob_public_access": { "type": "string" },
          "arn": { "type": "string" },
          "block_public_acls": { "type": "boolean" },
          "block_public_policy": { "type": "boolean" },
          "bucket_policy_is_public": { "type": "boolean" },
          "cidr_ipv4": { "type": "string" },
          "container_definitions": {},
          "db_cluster_identifier": { "type": "string" },
          "event_notification_configuration": {},
          "group_id": { "type": "string" },
          "iam_policy": {},
          "id": { "type": "string" },
          "ignore_public_acls": { "type": "boolean" },
          "ingress_settings": {},
          "instance_id": { "type": "string" },
          "ip_configuration": {},
          "name": { "type": "string" },
          "network_interfaces": {},
          "network_mode": { "type": "string" },
          "policy": {},
          "policy_std": { "type": "string" },
          "public_access": { "type": "string" },
          "public_ips": {},
          "region": { "type": "string" },
          "resource_id": { "type": "string" },
          "resource_vpc_config": {},
          "restrict_public_buckets": { "type": "boolean" },
          "scheme": { "type": "string" },
          "security_groups": {},
          "service_name": { "type": "string" },
          "task_definition": {},
          "task_definition_arn": { "type": "string" },
          "vpc_id": { "type": "string" },
          "vpc_options": {},
          "vpc_security_groups": {}
        }
      },
      "IngestersCompliance": {
        "type": "object",
        "properties": {
          "@timestamp": { "type": "string" },
          "compliance_check_type": { "type": "string" },
          "compliance_node_type": { "type": "string" },
          "description": { "type": "string" },
          "doc_id": { "type": "string" },
          "kubernetes_cluster_id": { "type": "string" },
          "kubernetes_cluster_name": { "type": "string" },
          "masked": { "type": "string" },
          "node_id": { "type": "string" },
          "node_name": { "type": "string" },
          "node_type": { "type": "string" },
          "remediation_ansible": { "type": "string" },
          "remediation_puppet": { "type": "string" },
          "remediation_script": { "type": "string" },
          "resource": { "type": "string" },
          "scan_id": { "type": "string" },
          "status": { "type": "string" },
          "test_category": { "type": "string" },
          "test_desc": { "type": "string" },
          "test_number": { "type": "string" },
          "test_rationale": { "type": "string" },
          "test_severity": { "type": "string" },
          "time_stamp": { "type": "integer" },
          "type": { "type": "string" }
        }
      },
      "IngestersSecret": {
        "type": "object",
        "properties": {
          "@timestamp": { "type": "string", "format": "date-time" },
          "ImageLayerId": { "type": "string" },
          "Match": {
            "type": "object",
            "properties": {
              "full_filename": { "type": "string" },
              "matched_content": { "type": "string" },
              "relative_ending_index": { "type": "integer" },
              "relative_starting_index": { "type": "integer" },
              "starting_index": { "type": "integer" }
            }
          },
          "Rule": {
            "type": "object",
            "properties": {
              "id": { "type": "integer" },
              "name": { "type": "string" },
              "part": { "type": "string" },
              "signature_to_match": { "type": "string" }
            }
          },
          "Severity": {
            "type": "object",
            "properties": { "level": { "type": "string" }, "score": { "type": "number" } }
          },
          "container_name": { "type": "string" },
          "host_name": { "type": "string" },
          "kubernetes_cluster_name": { "type": "string" },
          "masked": { "type": "string" },
          "node_id": { "type": "string" },
          "node_name": { "type": "string" },
          "node_type": { "type": "string" },
          "scan_id": { "type": "string" }
        }
      },
      "IngestersSecretScanStatus": {
        "type": "object",
        "properties": {
          "@timestamp": { "type": "string", "format": "date-time" },
          "container_name": { "type": "string" },
          "host_name": { "type": "string" },
          "kubernetes_cluster_name": { "type": "string" },
          "masked": { "type": "string" },
          "node_id": { "type": "string" },
          "node_name": { "type": "string" },
          "node_type": { "type": "string" },
          "scan_id": { "type": "string" },
          "scan_status": { "type": "string" }
        }
      },
      "IngestersVulnerability": {
        "type": "object",
        "properties": {
          "@timestamp": { "type": "string" },
          "count": { "type": "integer" },
          "cve_attack_vector": { "type": "string" },
          "cve_caused_by_package": { "type": "string" },
          "cve_caused_by_package_path": { "type": "string" },
          "cve_container_image": { "type": "string" },
          "cve_container_image_id": { "type": "string" },
          "cve_container_layer": { "type": "string" },
          "cve_container_name": { "type": "string" },
          "cve_cvss_score": { "type": "number" },
          "cve_description": { "type": "string" },
          "cve_fixed_in": { "type": "string" },
          "cve_id": { "type": "string" },
          "cve_id_cve_severity_cve_container_image": { "type": "string" },
          "cve_link": { "type": "string" },
          "cve_overall_score": { "type": "number" },
          "cve_severity": { "type": "string" },
          "cve_type": { "type": "string" },
          "doc_id": { "type": "string" },
          "exploit_poc": { "type": "string" },
          "host": { "type": "string" },
          "host_name": { "type": "string" },
          "kubernetes_cluster_name": { "type": "string" },
          "masked": { "type": "string" },
          "node_type": { "type": "string" },
          "scan_id": { "type": "string" },
          "type": { "type": "string" },
          "urls": { "type": "array", "items": { "type": "string" }, "nullable": true }
        }
      },
      "ModelAgentId": {
        "required": ["node_id"],
        "type": "object",
        "properties": { "node_id": { "type": "string" } }
      },
      "ModelApiAuthRequest": {
        "required": ["api_token"],
        "type": "object",
        "properties": { "api_token": { "type": "string" } }
      },
      "ModelComputeMetrics": {
        "required": ["cpu_percent", "memory_mb"],
        "type": "object",
        "properties": {
          "cpu_percent": { "type": "number" },
          "memory_mb": { "type": "number" }
        }
      },
      "ModelContainer": {
        "required": [
          "node_id",
          "name",
          "image",
          "processes",
          "metrics",
          "metadata",
          "docker_labels",
          "host_name"
        ],
        "type": "object",
        "properties": {
          "docker_labels": { "$ref": "#/components/schemas/ModelMetadata" },
          "host_name": { "type": "string" },
          "image": { "$ref": "#/components/schemas/ModelImage" },
          "metadata": { "$ref": "#/components/schemas/ModelMetadata" },
          "metrics": { "$ref": "#/components/schemas/ModelComputeMetrics" },
          "name": { "type": "string" },
          "node_id": { "type": "string" },
          "processes": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelProcess" },
            "nullable": true
          }
        }
      },
      "ModelFetchWindow": {
        "required": ["offset", "size"],
        "type": "object",
        "properties": { "offset": { "type": "integer" }, "size": { "type": "integer" } }
      },
      "ModelHost": {
        "required": [
          "node_id",
          "host_name",
          "containers",
          "processes",
          "pods",
          "cloud_metadata",
          "metrics"
        ],
        "type": "object",
        "properties": {
          "cloud_metadata": { "$ref": "#/components/schemas/ModelMetadata" },
          "containers": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelContainer" },
            "nullable": true
          },
          "host_name": { "type": "string" },
          "metrics": { "$ref": "#/components/schemas/ModelComputeMetrics" },
          "node_id": { "type": "string" },
          "pods": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelPod" },
            "nullable": true
          },
          "processes": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelProcess" },
            "nullable": true
          }
        }
      },
      "ModelImage": {
        "required": ["id", "name", "tag", "size_mb", "virtual_mb", "metrics", "metadata"],
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "metadata": { "$ref": "#/components/schemas/ModelMetadata" },
          "metrics": { "$ref": "#/components/schemas/ModelComputeMetrics" },
          "name": { "type": "string" },
          "size_mb": { "type": "string" },
          "tag": { "type": "string" },
          "virtual_mb": { "type": "string" }
        }
      },
      "ModelLoginRequest": {
        "required": ["email", "password"],
        "type": "object",
        "properties": { "email": { "type": "string" }, "password": { "type": "string" } }
      },
      "ModelMetadata": { "type": "object", "additionalProperties": {} },
      "ModelPod": {
        "required": [
          "node_id",
          "name",
          "image",
          "metrics",
          "containers",
          "processes",
          "metadata"
        ],
        "type": "object",
        "properties": {
          "containers": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelContainer" },
            "nullable": true
          },
          "image": { "type": "string" },
          "metadata": { "$ref": "#/components/schemas/ModelMetadata" },
          "metrics": { "$ref": "#/components/schemas/ModelComputeMetrics" },
          "name": { "type": "string" },
          "node_id": { "type": "string" },
          "processes": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelProcess" },
            "nullable": true
          }
        }
      },
      "ModelProcess": {
        "required": [
          "node_id",
          "name",
          "pid",
          "command",
          "ppid",
          "thread_number",
          "metrics",
          "metadata"
        ],
        "type": "object",
        "properties": {
          "command": { "type": "string" },
          "metadata": { "$ref": "#/components/schemas/ModelMetadata" },
          "metrics": { "$ref": "#/components/schemas/ModelComputeMetrics" },
          "name": { "type": "string" },
          "node_id": { "type": "string" },
          "pid": { "type": "string" },
          "ppid": { "type": "string" },
          "thread_number": { "type": "integer" }
        }
      },
      "ModelRawReport": {
        "required": ["payload"],
        "type": "object",
        "properties": { "payload": { "type": "string" } }
      },
      "ModelResponse": {
        "type": "object",
        "properties": {
          "data": { "$ref": "#/components/schemas/ModelResponseAccessToken" },
          "error_fields": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "nullable": true
          },
          "message": { "type": "string" },
          "success": { "type": "boolean" }
        }
      },
      "ModelResponseAccessToken": {
        "required": ["access_token", "refresh_token"],
        "type": "object",
        "properties": {
          "access_token": { "type": "string" },
          "refresh_token": { "type": "string" }
        }
      },
      "ModelScanInfo": {
        "required": ["scan_id", "status", "updated_at"],
        "type": "object",
        "properties": {
          "scan_id": { "type": "string" },
          "status": { "type": "string" },
          "updated_at": { "type": "integer", "format": "int64" }
        }
      },
      "ModelScanListReq": {
        "required": ["node_id", "window"],
        "type": "object",
        "properties": {
          "node_id": { "type": "string" },
          "window": { "$ref": "#/components/schemas/ModelFetchWindow" }
        }
      },
      "ModelScanListResp": {
        "required": ["scans_info"],
        "type": "object",
        "properties": {
          "scans_info": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ModelScanInfo" },
            "nullable": true
          }
        }
      },
      "ModelScanResultsReq": {
        "required": ["scan_id", "window"],
        "type": "object",
        "properties": {
          "scan_id": { "type": "string" },
          "window": { "$ref": "#/components/schemas/ModelFetchWindow" }
        }
      },
      "ModelScanResultsResp": {
        "required": ["results"],
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": { "type": "object", "additionalProperties": {} },
            "nullable": true
          }
        }
      },
      "ModelScanStatus": { "type": "string" },
      "ModelScanStatusResp": {
        "required": ["status"],
        "type": "object",
        "properties": { "status": { "$ref": "#/components/schemas/ModelScanStatus" } }
      },
      "ModelScanTriggerReq": {
        "required": ["node_id", "resource_id", "resource_type"],
        "type": "object",
        "properties": {
          "node_id": { "type": "string" },
          "resource_id": { "type": "string" },
          "resource_type": { "enum": ["image", "host", "container"], "type": "string" }
        }
      },
      "ModelScanTriggerResp": {
        "required": ["scan_id"],
        "type": "object",
        "properties": { "scan_id": { "type": "string" } }
      },
      "ModelUser": {
        "type": "object",
        "properties": {
          "company": { "type": "string" },
          "company_id": { "type": "integer" },
          "email": { "type": "string" },
          "first_name": { "type": "string" },
          "groups": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "nullable": true
          },
          "id": { "type": "integer" },
          "is_active": { "type": "boolean" },
          "last_name": { "type": "string" },
          "password_invalidated": { "type": "boolean" },
          "role": { "type": "string" },
          "role_id": { "type": "integer" }
        }
      },
      "ModelUserRegisterRequest": {
        "required": [
          "first_name",
          "last_name",
          "email",
          "company",
          "password",
          "is_temporary_password",
          "console_url"
        ],
        "type": "object",
        "properties": {
          "company": { "type": "string" },
          "console_url": { "type": "string" },
          "email": { "type": "string" },
          "first_name": { "type": "string" },
          "is_temporary_password": { "type": "boolean" },
          "last_name": { "type": "string" },
          "password": { "type": "string" }
        }
      },
      "PostgresqlDbApiToken": { "type": "object" },
      "ReportColumn": {
        "type": "object",
        "properties": {
          "dataType": { "type": "string" },
          "id": { "type": "string" },
          "label": { "type": "string" }
        }
      },
      "ReportIDList": { "type": "array", "items": { "type": "string" } },
      "ReportMetadataRow": {
        "type": "object",
        "properties": {
          "dataType": { "type": "string" },
          "id": { "type": "string" },
          "label": { "type": "string" },
          "priority": { "type": "number" },
          "truncate": { "type": "integer" },
          "value": { "type": "string" }
        }
      },
      "ReportMetricRow": { "type": "object" },
      "ReportRow": {
        "type": "object",
        "properties": {
          "entries": {
            "type": "object",
            "additionalProperties": { "type": "string" },
            "nullable": true
          },
          "id": { "type": "string" }
        }
      },
      "ReportTable": {
        "type": "object",
        "properties": {
          "columns": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ReportColumn" },
            "nullable": true
          },
          "id": { "type": "string" },
          "label": { "type": "string" },
          "rows": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ReportRow" },
            "nullable": true
          },
          "truncationCount": { "type": "integer" },
          "type": { "type": "string" }
        }
      },
      "ReportersContainsFilter": {
        "required": ["filter_in"],
        "type": "object",
        "properties": {
          "filter_in": {
            "type": "object",
            "additionalProperties": { "type": "array", "items": {} },
            "nullable": true
          }
        }
      },
      "ReportersFieldsFilters": {
        "required": ["contains_filter"],
        "type": "object",
        "properties": {
          "contains_filter": { "$ref": "#/components/schemas/ReportersContainsFilter" }
        }
      },
      "ReportersLookupFilter": {
        "required": ["in_field_filter", "node_ids"],
        "type": "object",
        "properties": {
          "in_field_filter": {
            "type": "array",
            "items": { "type": "string" },
            "nullable": true
          },
          "node_ids": { "type": "array", "items": { "type": "string" }, "nullable": true }
        }
      },
      "ReportersNodeInfo": {
        "required": [
          "node_id",
          "image_name",
          "name",
          "vulnerability_count",
          "vulnerability_scan_id",
          "secrets_count",
          "secrets_scan_id",
          "compliance_count",
          "compliance_scan_id"
        ],
        "type": "object",
        "properties": {
          "compliance_count": { "type": "integer" },
          "compliance_scan_id": { "type": "string" },
          "image_name": { "type": "string" },
          "name": { "type": "string" },
          "node_id": { "type": "string" },
          "secrets_count": { "type": "integer" },
          "secrets_scan_id": { "type": "string" },
          "vulnerability_count": { "type": "integer" },
          "vulnerability_scan_id": { "type": "string" }
        }
      },
      "ReportersProviderThreatGraph": {
        "required": [
          "resources",
          "compliance_count",
          "secrets_count",
          "vulnerability_count"
        ],
        "type": "object",
        "properties": {
          "compliance_count": { "type": "integer" },
          "resources": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/ReportersThreatNodeInfo" },
            "nullable": true
          },
          "secrets_count": { "type": "integer" },
          "vulnerability_count": { "type": "integer" }
        }
      },
      "ReportersThreatGraph": {
        "type": "object",
        "additionalProperties": {
          "$ref": "#/components/schemas/ReportersProviderThreatGraph"
        },
        "nullable": true
      },
      "ReportersThreatNodeInfo": {
        "required": [
          "label",
          "id",
          "nodes",
          "vulnerability_count",
          "secrets_count",
          "compliance_count",
          "count",
          "node_type",
          "attack_path"
        ],
        "type": "object",
        "properties": {
          "attack_path": {
            "type": "array",
            "items": { "type": "array", "items": { "type": "string" } },
            "nullable": true
          },
          "compliance_count": { "type": "integer" },
          "count": { "type": "integer" },
          "id": { "type": "string" },
          "label": { "type": "string" },
          "node_type": { "type": "string" },
          "nodes": {
            "type": "object",
            "additionalProperties": { "$ref": "#/components/schemas/ReportersNodeInfo" },
            "nullable": true
          },
          "secrets_count": { "type": "integer" },
          "vulnerability_count": { "type": "integer" }
        }
      },
      "ReportersTopologyFilters": {
        "required": [
          "cloud_filter",
          "region_filter",
          "kubernetes_filter",
          "host_filter",
          "pod_filter",
          "field_filters"
        ],
        "type": "object",
        "properties": {
          "cloud_filter": {
            "type": "array",
            "items": { "type": "string" },
            "nullable": true
          },
          "field_filters": { "$ref": "#/components/schemas/ReportersFieldsFilters" },
          "host_filter": {
            "type": "array",
            "items": { "type": "string" },
            "nullable": true
          },
          "kubernetes_filter": {
            "type": "array",
            "items": { "type": "string" },
            "nullable": true
          },
          "pod_filter": {
            "type": "array",
            "items": { "type": "string" },
            "nullable": true
          },
          "region_filter": {
            "type": "array",
            "items": { "type": "string" },
            "nullable": true
          }
        }
      }
    },
    "securitySchemes": {
      "bearer_token": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "RW Access"
      }
    }
  }
}
