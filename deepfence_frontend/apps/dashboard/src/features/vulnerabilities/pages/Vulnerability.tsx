import { HiArrowSmRight } from 'react-icons/hi';
import { IconContext } from 'react-icons/lib';
import { Card } from 'ui-components';

import { DFLink } from '@/components/DFLink';
import { MostExploitableCount } from '@/features/vulnerabilities/components/MostExploitablesVulnerabilities';
import { RuntimeBOMCount } from '@/features/vulnerabilities/components/RuntimeBom';
import { TopAttackPaths } from '@/features/vulnerabilities/components/TopAttackPaths';
import { TopVulnerableContainers } from '@/features/vulnerabilities/components/TopVulnerableContainers';
import { TopVulnerableHosts } from '@/features/vulnerabilities/components/TopVulnerableHosts';
import { TopVulnerableImages } from '@/features/vulnerabilities/components/TopVulnerableImages';
import { UniqueVulnerabilitiesCount } from '@/features/vulnerabilities/components/UniqueVulnerabilities';

const Vulnerability = () => {
  return (
    <div className="grid grid-cols-3 gap-2">
      <TopVulnerableContainers />
      <TopVulnerableHosts />
      <TopVulnerableImages />
      <div className="grid col-span-3 grid-cols-2 gap-2">
        <TopAttackPaths />
        <div className="grid gap-2">
          <Card className="min-h-[100px] p-2 grid grid-flow-row">
            <div className="flex items-center">
              <h4 className="text-gray-900 text-md dark:text-white">
                Most Exploitable Vulnerabilities
              </h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <MostExploitableCount />
          </Card>

          <Card className="min-h-[100px] p-2 grid grid-flow-row">
            <div className="flex">
              <h4 className="text-gray-900 text-md dark:text-white">
                Unique Vulnerabilities
              </h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <UniqueVulnerabilitiesCount />
          </Card>

          <Card className="min-h-[100px] p-2 grid grid-flow-row">
            <div className="flex">
              <h4 className="text-gray-900 text-md dark:text-white">Runtime BOM</h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <RuntimeBOMCount />
          </Card>
        </div>
      </div>
    </div>
  );
};

export const module = {
  element: <Vulnerability />,
};
