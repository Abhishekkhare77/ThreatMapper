import { HiArrowSmRight } from 'react-icons/hi';
import { IconContext } from 'react-icons/lib';
import { Card } from 'ui-components';

import { DFLink } from '@/components/DFLink';
import { MostExploitableCount } from '@/features/vulnerabilities/components/landing/MostExploitablesVulnerabilities';
import { TopAttackPaths } from '@/features/vulnerabilities/components/landing/TopAttackPaths';
import { TopVulnerableContainers } from '@/features/vulnerabilities/components/landing/TopVulnerableContainers';
import { TopVulnerableHosts } from '@/features/vulnerabilities/components/landing/TopVulnerableHosts';
import { TopVulnerableImages } from '@/features/vulnerabilities/components/landing/TopVulnerableImages';
import { UniqueVulnerabilitiesCount } from '@/features/vulnerabilities/components/landing/UniqueVulnerabilities';

const Vulnerability = () => {
  return (
    <div>
      <div className="flex flex-col p-1 pl-2 w-full dark:bg-gray-800">
        <span className="text-lg font-medium text-gray-700 dark:text-gray-200">
          Vulnerability
        </span>
      </div>
      <div className="m-2 grid grid-cols-3 gap-2">
        <TopVulnerableContainers />
        <TopVulnerableHosts />
        <TopVulnerableImages />
        <div className="grid col-span-3 grid-cols-2 gap-2">
          <TopAttackPaths />
          <div className="grid gap-2">
            <Card className="min-h-[100px] p-2 grid grid-flow-row">
              <div className="flex flex-col">
                <div className="grid p-2 grid-flow-col">
                  <h4 className="text-gray-900 text-sm dark:text-white">
                    Most Exploitable Vulnerabilities
                  </h4>
                  <DFLink to={'/'} className="flex hover:no-underline ml-auto mr-2">
                    <span className="text-xs text-blue-600 dark:text-blue-500">
                      Details
                    </span>
                    <IconContext.Provider
                      value={{
                        className: 'text-blue-600 dark:text-blue-500 ',
                      }}
                    >
                      <HiArrowSmRight />
                    </IconContext.Provider>
                  </DFLink>
                </div>
                <MostExploitableCount />
              </div>
            </Card>

            <Card className="min-h-[100px] p-2 grid grid-flow-row">
              <div className="grid p-2 grid-flow-col">
                <h4 className="text-gray-900 text-sm dark:text-white">
                  Unique Vulnerabilities
                </h4>
                <DFLink to={'/'} className="flex hover:no-underline ml-auto mr-2">
                  <span className="text-xs text-blue-600 dark:text-blue-500">
                    Details
                  </span>
                  <IconContext.Provider
                    value={{
                      className: 'text-blue-600 dark:text-blue-500 ',
                    }}
                  >
                    <HiArrowSmRight />
                  </IconContext.Provider>
                </DFLink>
              </div>
              <UniqueVulnerabilitiesCount />
            </Card>
          </div>
        </div>
      </div>
    </div>
  );
};

export const module = {
  element: <Vulnerability />,
};
