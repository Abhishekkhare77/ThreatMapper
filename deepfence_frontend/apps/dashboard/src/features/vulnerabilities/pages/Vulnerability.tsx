import { HiArrowSmRight, HiArrowUp } from 'react-icons/hi';
import { IconContext } from 'react-icons/lib';
import { Card } from 'ui-components';

import { DFLink } from '@/components/DFLink';
import { MostExploitableChartVertial } from '@/features/vulnerabilities/components/landing/MostExploitableChartVertical';
import { MostExploitableCount } from '@/features/vulnerabilities/components/landing/MostExploitablesVulnerabilities';
import { TopAttackPaths } from '@/features/vulnerabilities/components/landing/TopAttackPaths';
import { TopVulnerableContainers } from '@/features/vulnerabilities/components/landing/TopVulnerableContainers';
import { TopVulnerableHosts } from '@/features/vulnerabilities/components/landing/TopVulnerableHosts';
import { TopVulnerableImages } from '@/features/vulnerabilities/components/landing/TopVulnerableImages';
import { UniqueVulnerabilitiesCount } from '@/features/vulnerabilities/components/landing/UniqueVulnerabilities';
import { UniqueVulnerabilitiesCountVertical } from '@/features/vulnerabilities/components/landing/UniqueVulnerabilitiesVertical';
import { useTheme } from '@/theme/ThemeContext';

const CardViewType: any = 'vertical';

const Vulnerability = () => {
  const { mode } = useTheme();
  return (
    <div>
      <div className="flex flex-col p-2 w-full shadow bg-white dark:bg-gray-800">
        <span className="text-md font-medium text-gray-700 dark:text-gray-200 uppercase">
          Vulnerabilities
        </span>
      </div>
      <div className="m-2 grid grid-cols-6 gap-2">
        <div className="col-span-2">
          <TopVulnerableContainers />
        </div>
        <div className="col-span-2">
          <TopVulnerableHosts />
        </div>
        <div className="col-span-2">
          <TopVulnerableImages />
        </div>
        <div className="col-span-3">
          <TopAttackPaths />
        </div>
        {CardViewType === 'horizontal' && (
          <div className="col-span-3 flex flex-col gap-2">
            <Card className="flex flex-1 p-2">
              <div className="flex flex-col flex-1">
                <div className="p-2 flex">
                  <h4 className="text-gray-900 text-sm dark:text-white">
                    Most Exploitable Vulnerabilities
                  </h4>
                  <DFLink to={'/'} className="flex hover:no-underline ml-auto mr-2">
                    <span className="text-xs text-blue-600 dark:text-blue-500">
                      Details
                    </span>
                    <IconContext.Provider
                      value={{
                        className: 'text-blue-600 dark:text-blue-500 ',
                      }}
                    >
                      <HiArrowSmRight />
                    </IconContext.Provider>
                  </DFLink>
                </div>
                <MostExploitableCount theme={mode} />
              </div>
            </Card>
            <Card className="flex flex-1 p-2">
              <div className="flex flex-col flex-1">
                <div className="p-2 flex">
                  <h4 className="text-gray-900 text-sm dark:text-white">
                    Unique Vulnerabilities
                  </h4>
                  <DFLink to={'/'} className="flex hover:no-underline ml-auto mr-2">
                    <span className="text-xs text-blue-600 dark:text-blue-500">
                      Details
                    </span>
                    <IconContext.Provider
                      value={{
                        className: 'text-blue-600 dark:text-blue-500 ',
                      }}
                    >
                      <HiArrowSmRight />
                    </IconContext.Provider>
                  </DFLink>
                </div>
                <UniqueVulnerabilitiesCount theme={mode} />
              </div>
            </Card>
          </div>
        )}

        {CardViewType === 'vertical' && (
          <div className="col-span-3 flex gap-2 min-h-full items-stretch">
            {['Unique Vulnerabilities', 'Most Exploitable Vulnerabilities'].map(
              (type) => {
                return (
                  <div className="flex-1" key={type}>
                    <Card className="flex h-full p-2">
                      <div className="flex flex-col flex-1">
                        <div className="p-2 flex">
                          <h4 className="text-gray-900 text-sm dark:text-white">
                            Unique Vulnerabilities
                          </h4>
                          <DFLink
                            to={'/'}
                            className="flex hover:no-underline ml-auto mr-2"
                          >
                            <span className="text-xs text-blue-600 dark:text-blue-500">
                              Details
                            </span>
                            <IconContext.Provider
                              value={{
                                className: 'text-blue-600 dark:text-blue-500 ',
                              }}
                            >
                              <HiArrowSmRight />
                            </IconContext.Provider>
                          </DFLink>
                        </div>
                        <div className="flex flex-col gap-2 items-center justify-center">
                          <div className="flex-1 min-h-[250px] self-stretch">
                            <MostExploitableChartVertial theme={mode} />
                          </div>
                          <div className="flex-1 pt-4">
                            <div className="flex gap-4">
                              <div className="text-[2.5rem] text-gray-900 dark:text-gray-200 font-light">
                                923
                              </div>
                              <div>
                                <div className="text-base text-gray-400 dark:text-gray-500 pt-1">
                                  {type}
                                </div>
                                <div className="flex text-red-500 dark:text-red-400 items-center">
                                  <IconContext.Provider
                                    value={{
                                      className: 'text-red-500 dark:text-red-400',
                                    }}
                                  >
                                    <HiArrowUp />
                                  </IconContext.Provider>
                                  <div>+30 NEW</div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div>
                            <UniqueVulnerabilitiesCountVertical />
                          </div>
                        </div>
                      </div>
                    </Card>
                  </div>
                );
              },
            )}
          </div>
        )}
      </div>
    </div>
  );
};

export const module = {
  element: <Vulnerability />,
};
