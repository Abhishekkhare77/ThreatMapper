import { HiArrowSmRight } from 'react-icons/hi';
import { IconContext } from 'react-icons/lib';
import { Card } from 'ui-components';

import AttackPath from '@/assets/attack-path.png';
import { DFLink } from '@/components/DFLink';
import {
  MostExploitable,
  MostExploitableCount,
} from '@/features/vulnerabilities/components/MostExploitable';
import { RuntimeBOMCount } from '@/features/vulnerabilities/components/RuntimeBom';
import {
  DagreeSelector,
  DagreGraph,
} from '@/features/vulnerabilities/components/TopAttackPath';
import { TopContainers } from '@/features/vulnerabilities/components/TopContainers';
import {
  UniqueVulnerabilities,
  UniqueVulnerabilitiesCount,
} from '@/features/vulnerabilities/components/UniqueVulnerabilities';

const Vulnerability = () => {
  return (
    <div className="grid grid-cols-3 gap-2">
      <Card className="w-full p-2">
        <div className="flex">
          <h4 className="p-2 text-gray-900 text-md dark:text-white">
            Top Vulnerable Running Containers
          </h4>
          <DFLink to={'/'} className="flex items-center hover:no-underline ml-auto mr-2">
            <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
            <IconContext.Provider
              value={{
                className: 'text-blue-600 dark:text-blue-500 ',
              }}
            >
              <HiArrowSmRight />
            </IconContext.Provider>
          </DFLink>
        </div>
        <TopContainers />
      </Card>

      <Card className="">
        <div className="flex">
          <h4 className="p-2 text-gray-900 text-md dark:text-white">
            Top Vulnerable Running Hosts
          </h4>
          <DFLink to={'/'} className="flex items-center hover:no-underline ml-auto mr-2">
            <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
            <IconContext.Provider
              value={{
                className: 'text-blue-600 dark:text-blue-500 ',
              }}
            >
              <HiArrowSmRight />
            </IconContext.Provider>
          </DFLink>
        </div>
        <TopContainers />
      </Card>

      <Card className="">
        <div className="flex">
          <h4 className="p-2 text-gray-900 text-md dark:text-white">
            Top Vulnerable Running Images
          </h4>
          <DFLink to={'/'} className="flex items-center hover:no-underline ml-auto mr-2">
            <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
            <IconContext.Provider
              value={{
                className: 'text-blue-600 dark:text-blue-500 ',
              }}
            >
              <HiArrowSmRight />
            </IconContext.Provider>
          </DFLink>
        </div>
        <TopContainers />
      </Card>
      <div className="grid col-span-3 grid-cols-2 gap-2">
        <Card className="w-full p-2">
          <div className="min-h-[200px]">
            <div className="flex">
              <h4 className="text-gray-900 text-md dark:text-white">Top Attack Paths</h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <div className="flex items-center">
              <DagreGraph />
              <DagreeSelector />
            </div>
          </div>
        </Card>
        <div className="grid gap-2">
          <Card className="min-h-[100px] p-2">
            <div className="flex items-center">
              <h4 className="text-gray-900 text-md dark:text-white">
                Most Exploitable Vulnerabilities
              </h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <MostExploitableCount />
          </Card>

          <Card className="min-h-[100px] p-2">
            <div className="flex">
              <h4 className="text-gray-900 text-md dark:text-white">
                Unique Vulnerabilities
              </h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <UniqueVulnerabilitiesCount />
          </Card>

          <Card className="min-h-[100px] p-2">
            <div className="flex">
              <h4 className="text-gray-900 text-md dark:text-white">Runtime BOM</h4>
              <DFLink
                to={'/'}
                className="flex items-center hover:no-underline ml-auto mr-2"
              >
                <span className="text-xs text-blue-600 dark:text-blue-500">Details</span>
                <IconContext.Provider
                  value={{
                    className: 'text-blue-600 dark:text-blue-500 ',
                  }}
                >
                  <HiArrowSmRight />
                </IconContext.Provider>
              </DFLink>
            </div>
            <RuntimeBOMCount />
          </Card>
        </div>
      </div>
    </div>
  );
};

export const module = {
  element: <Vulnerability />,
};
